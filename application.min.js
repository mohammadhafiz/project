var application=angular.module("application",["ngAnimate","ngAria","ngMaterial","ngMessageFormat","ngMessages","ngResource","ngRoute","ngSanitize","pascalprecht.translate","application.templates"]);application.config(["$locationProvider","$routeProvider",function(e,t){e.html5Mode(!0).hashPrefix("#!"),t.when("/login",{controller:"LoginController",templateUrl:"/templates/login.html",resolve:{guest_only:["$q","Auth",function(e,t){var a=e.defer();return t.isLogged()?a.reject("guest_only"):a.resolve(),a.promise}]}}).when("/modules",{controller:"ModulesController",templateUrl:"/templates/modules.html",resolve:{member_only:["$q","Auth",function(e,t){var a=e.defer();return t.isLogged()?a.resolve():a.reject("member_only"),a.promise}]}}).when("/access_control",{}).otherwise({redirectTo:"/login"})}]),application.config(["$mdThemingProvider",function(e){e.theme("default").primaryPalette("indigo").accentPalette("pink").warnPalette("orange").backgroundPalette("grey"),e.theme("indigo").primaryPalette("indigo").accentPalette("pink").warnPalette("orange").backgroundPalette("grey"),e.theme("indigoBackground").primaryPalette("indigo").accentPalette("pink").warnPalette("orange").backgroundPalette("indigo")}]),application.config(["$translateProvider",function(e){e.useSanitizeValueStrategy("sanitize"),e.preferredLanguage("en")}]),application.config(["$httpProvider",function(e){e.defaults.headers={common:{Accept:"application/vnd.menggaris.v1+json"},post:{"Content-Type":"application/json"},put:{"Content-Type":"application/json"},"delete":{"Content-Type":"application/json"}},e.interceptors.push("AuthInterceptor")}]),application.run(["$location","$rootScope",function(e,t){t.$on("$routeChangeError",function(t,a,n,o){switch(o){case"guest_only":e.path("/modules");break;case"member_only":e.path("/login")}})}]),application.config(["$translateProvider",function(e){e.translations("en",{action_login:"Log in",action_logout:"Log out",label_password:"Password",label_username:"Username",placeholder:"Placeholder",title_access_control:"Access Control",title_arrears_management:"Arrears Management",title_login:"Login",title_modules:"Modules",title_settings:"Settings",validation_maxlength_24:"This field may not be greater than 24 characters.",validation_minlength_4:"This field must be at least 4 characters.",validation_required:"This field is required."})}]),application.config(["$translateProvider",function(e){e.translations("ms",{title_login:"Log masuk",label_username:"Kata nama",label_password:"Kata kunci",button_login:"Log masuk"})}]),application.controller("LoginController",["$location","$scope","Auth",function(e,t,a){t.credentials={username:"",password:""},t.login=function(t){a.verify(t).then(function(t){e.path("/modules")})}}]),application.controller("ModulesController",["$location","$scope","$timeout","Auth","User",function(e,t,a,n,o){o.query({limit:3,username:"~a%"},function(e){console.info(e)}),t.logout=function(){a(function(){n.forget().then(function(){e.path("/login")})},300)}}]),application.factory("API",["Settings",function(e){var t={};return t.access_token="/api/access_token",t.session="/api/session",t.users="/api/users/:user_id",t.scopes="/api/scopes/{scopes}",t.grants="/api/grants/{grants}",t.clients="/api/clients/{clients}",t.get=function(a){return e.host.concat(t[a])},t}]),application.factory("Auth",["$http","$q","$window","API","Error","Settings",function(e,t,a,n,o,r){var i={};return i.forget=function(){var e=t.defer();return a.localStorage.removeItem("expires_in"),a.localStorage.removeItem("access_token"),a.localStorage.removeItem("refresh_token"),a.localStorage.removeItem("token_type"),e.resolve(),e.promise},i.handler=function(e){return a.localStorage.expires_in=e.data.expires_in,a.localStorage.access_token=e.data.access_token,a.localStorage.refresh_token=e.data.refresh_token,a.localStorage.token_type=e.data.token_type,e},i.handle=function(){return i.handler},i.isLogged=function(){return a.localStorage.hasOwnProperty("expires_in")&&a.localStorage.hasOwnProperty("access_token")&&a.localStorage.hasOwnProperty("refresh_token")&&a.localStorage.hasOwnProperty("token_type")},i.refresh=function(){var t={grant_type:"refresh_token",client_id:r.client_id,client_secret:r.client_secret,scope:r.scopes.join(),refresh_token:a.localStorage.refresh_token};return e.post(n.get("access_token"),t).then(i.handle())["catch"](o.handle())},i.verify=function(t){var a={grant_type:"password",client_id:r.client_id,client_secret:r.client_secret,scope:r.scopes.join(),username:t.username,password:t.password};return e.post(n.get("access_token"),a).then(i.handle())["catch"](o.handle())},i}]),application.factory("AuthInterceptor",["$q","$window",function(e,t){var a={};return a.request=function(e){if(t.localStorage.hasOwnProperty("expires_in")&&t.localStorage.hasOwnProperty("access_token")&&t.localStorage.hasOwnProperty("refresh_token")&&t.localStorage.hasOwnProperty("token_type")){var a=t.localStorage.token_type,n=t.localStorage.access_token;e.headers.Authorization=a+" "+n}return e},a.responseError=function(t){return console.error(t),e.reject(reject)},a}]),application.factory("Error",["$q",function(e){var t={};return t.handler=function(t){return console.error(t),e.reject(t)},t.handle=function(){return t.handler},t}]),application.factory("Settings",[function(){var e={};return e.host="http://homestead.app",e.client_id="1111111111111111111111111111111111111111",e.client_secret="passwordpasswordpasswordpasswordpassword",e.scopes=["create_client_data","read_client_data","update_client_data","delete_client_data","create_grant_data","read_grant_data","update_grant_data","delete_grant_data","create_scope_data","read_scope_data","update_scope_data","delete_scope_data","create_user_data","read_user_data","update_user_data","delete_user_data"],e}]),application.factory("User",["$resource","API",function(e,t){return e(t.get("users"),null,{query:{isArray:!1}})}]);
//# sourceMappingURL=application.min.js.map