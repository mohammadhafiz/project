var application=angular.module("application",["ngAnimate","ngAria","ngMaterial","ngMessageFormat","ngMessages","ngResource","ngRoute","ngSanitize","pascalprecht.translate","application.settings","application.templates"]);application.config(["$httpProvider",function(e){e.defaults.headers={common:{Accept:"application/vnd.menggaris.v1+json"},post:{"Content-Type":"application/json"},put:{"Content-Type":"application/json"},"delete":{"Content-Type":"application/json"}},e.interceptors.push("HttpInterceptor")}]),application.config(["$mdThemingProvider",function(e){e.alwaysWatchTheme(!0),e.theme("red").primaryPalette("red").accentPalette("indigo"),e.theme("white").primaryPalette("grey",{"default":"200"}).accentPalette("blue")}]),application.config(["$translateProvider",function(e){e.useSanitizeValueStrategy("sanitize"),e.preferredLanguage("en")}]),application.config(["$locationProvider","$routeProvider",function(e,t){e.html5Mode(!0).hashPrefix("#!"),t.when("/login",{controller:"LoginController",templateUrl:"login.html",resolve:{isGuest:["Auth",function(e){return e.isGuest()}]}}).when("/modules",{controller:"ModulesController",templateUrl:"modules.html",resolve:{isLogged:["Auth",function(e){return e.isLogged()}],session:["Auth",function(e){return e.session()}]}}).when("/access_control/users",{controller:"AccessControlUsersController",templateUrl:"access_control/users.html",resolve:{isLogged:["Auth",function(e){return e.isLogged()}]}}).when("/access_control/users/add",{controller:"AccessControlUsersCreateController",templateUrl:"access_control/users/create.html",resolve:{isLogged:["Auth",function(e){return e.isLogged()}]}}).when("/access_control/users/:user_id",{controller:"AccessControlUsersReadController",templateUrl:"access_control/users/read.html",resolve:{isLogged:["Auth",function(e){return e.isLogged()}],user:["$route","User",function(e,t){return t.get({user_id:e.current.params.user_id}).$promise}]}}).when("/access_control/clients",{controller:"AccessControlClientsController",templateUrl:"access_control/clients.html",resolve:{isLogged:["Auth",function(e){return e.isLogged()}]}}).when("/access_control/clients/create",{controller:"AccessControlClientsCreateController",templateUrl:"access_control/clients/create.html",resolve:{isLogged:["Auth",function(e){return e.isLogged()}]}}).when("/access_control/grants",{}).when("/access_control/scopes",{}).otherwise({redirectTo:"/login"})}]),application.run(["$location","$rootScope","Auth",function(e,t,n){t.$on("$routeChangeError",function(t,o,r,a){switch(a){case"auth.is_guest":e.path("/modules");break;case"auth.is_logged":n.forget()}})}]),application.config(["$translateProvider",function(e){e.translations("en",{action_add:"Add",action_back:"Go back",action_cancel:"Cancel",action_create:"Create",action_delete:"Delete",action_login:"Log in",action_logout:"Log out",action_menu:"Menu",action_more:"More",action_search:"Search",action_add_user:"Add new user",dialog_content_delete_record:"Deleted record cannot be restored.",dialog_title_delete_record:"Would you like to delete this record?",label_created_at:"Created At",label_name:"Name",label_password:"Password",label_password_confirmation:"Password Confirmation",label_updated_at:"Updated At",label_username:"Username",placeholder:"Placeholder",title_access_control:"Access Control",title_arrears_management:"Arrears Management",title_client_management:"Client Management",title_grant_management:"Grant Management",title_login:"Log In",title_menu:"Menu",title_modules:"Module List",title_record_count:"Showing total of {{ length }} record",title_scope_management:"Scope Management",title_settings:"Settings",title_user_management:"User Management",toast_incorrect_credentials:"The user credentials is incorrect.",toast_invalid_refresh_token:"The refresh token is invalid.",toast_validation_failed:"Validation failed on server.",validation_maxlength_24:"This field may not be greater than 24 characters.",validation_maxlength_250:"This field may not be greater than 250 characters.",validation_minlength_4:"This field must be at least 4 characters.",validation_required:"This field is required."})}]),application.config(["$translateProvider",function(e){e.translations("ms",{title_login:"Log masuk",label_username:"Kata nama",label_password:"Kata kunci",button_login:"Log masuk"})}]),application.controller("AccessControlController",["$location","$scope",function(e,t){t.modules=function(){e.path("/modules")},t.clientManagement=function(){e.path("/access_control/clients")},t.grantManagement=function(){e.path("/access_control/grants")},t.scopeManagement=function(){e.path("/access_control/scopes")},t.userManagement=function(){e.path("/access_control/users")}}]),application.controller("LoginController",["$location","$scope","Auth","isGuest",function(e,t,n,o){t.credentials={username:"",password:""},t.login=function(t){n.verify(t).then(function(t){e.path("/modules")})}}]),application.controller("ModulesController",["$location","$scope","$timeout","Auth","isLogged","session",function(e,t,n,o,r,a){t.accessControl=function(){n(function(){e.path("/access_control/users")},500)},t.logout=function(){n(function(){o.forget()},500)}}]),application.controller("AccessControlClientsController",["$location","$mdDialog","$mdSidenav","$scope","$translate","Client",function(e,t,n,o,r,a){o.limit=50,o.page=0,o.theme="red",o.clients=[],o.create=function(){e.path("/access_control/clients/create")},o["delete"]=function(n,c){r(["dialog_title_delete_record","dialog_content_delete_record","action_delete","action_cancel"]).then(function(e){return t.confirm().title(e.dialog_title_delete_record).content(e.dialog_content_delete_record).ok(e.action_delete).cancel(e.action_cancel).targetEvent(n)}).then(function(e){return t.show(e)}).then(function(){return a["delete"]({client_id:client.id}).$promise}).then(function(){o.clients.splice(o.clients.indexOf(client),1),e.path("/access_control/clients")})},o.load=function(){var e={};e.limit=o.limit,++o.page>1&&(e.skip=o.limit*(o.page-1)),a.query(e).$promise.then(function(e){e.data.length<1||(o.clients=o.clients.concat(e.data),o.load())})},o.menu=function(){n("menu").open()},o.read=function(t){e.path("/access_control/clients/"+t.id)},o.regex=function(e,t){return e.match(new RegExp(t,"i"))},o.load()}]),application.controller("AccessControlUsersController",["$location","$mdDialog","$mdSidenav","$scope","$translate","User",function(e,t,n,o,r,a){o.limit=50,o.page=0,o.theme="red",o.users=[],o.add=function(){e.path("/access_control/users/add")},o["delete"]=function(n,c){r(["dialog_title_delete_record","dialog_content_delete_record","action_delete","action_cancel"]).then(function(e){return t.confirm().title(e.dialog_title_delete_record).content(e.dialog_content_delete_record).ok(e.action_delete).cancel(e.action_cancel).targetEvent(n)}).then(function(e){return t.show(e)}).then(function(){return a["delete"]({user_id:c.id}).$promise}).then(function(){o.users.splice(o.users.indexOf(c),1),e.path("/access_control/users")})},o.load=function(){var e={};e.limit=o.limit,++o.page>1&&(e.skip=o.limit*(o.page-1)),a.query(e).$promise.then(function(e){e.data.length<1||(o.users=o.users.concat(e.data),o.load())})},o.menu=function(){n("menu").open()},o.read=function(t){e.path("/access_control/users/"+t.id)},o.regex=function(e,t){return e.match(new RegExp(t,"i"))},o.load()}]),application.controller("AccessControlClientsCreateController",["$location","$scope","Client",function(e,t,n){t.data={name:""},t.create=function(t){var o=new n(t);o.$save().then(function(){e.path("/access_control/clients")})},t.back=function(){e.path("/access_control/clients")}}]),application.controller("AccessControlUsersCreateController",["$location","$scope","User",function(e,t,n){t.data={username:"",password:"",password_confirmation:""},t.add=function(t){var o=new n(t);o.$save().then(function(){e.path("/access_control/users")})},t.back=function(){e.path("/access_control/users")}}]),application.controller("AccessControlUsersReadController",["$location","$mdDialog","$scope","$translate","User","user",function(e,t,n,o,r,a){n.user=a.data,n.back=function(){e.path("/access_control/users")},n["delete"]=function(n,a){o(["dialog_title_delete_record","dialog_content_delete_record","action_delete","action_cancel"]).then(function(e){return t.confirm().title(e.dialog_title_delete_record).content(e.dialog_content_delete_record).ok(e.action_delete).cancel(e.action_cancel).targetEvent(n)}).then(function(e){return t.show(e)}).then(function(){return r["delete"]({user_id:a}).$promise}).then(function(){e.path("/access_control/users")})}}]),application.factory("API",["Settings",function(e){var t={};return t.access_token="/api/access_token",t.session="/api/session",t.users="/api/users/:user_id",t.scopes="/api/scopes/:scope_id",t.grants="/api/grants/:grant_id",t.grantScopes="/api/grants/:grant_id/scopes/:scope_id",t.clients="/api/clients/:client_id",t.clientGrants="/api/clients/:client_id/grants/:grant_id",t.clientScopes="/api/clients/:client_id/scopes/:scope_id",t.get=function(n){return e.host.concat(t[n])},t}]),application.factory("Auth",["$http","$location","$q","$window","API","Settings",function(e,t,n,o,r,a){var c={};return c.forget=function(){var e=n.defer();return o.localStorage.removeItem("expires_in"),o.localStorage.removeItem("access_token"),o.localStorage.removeItem("refresh_token"),o.localStorage.removeItem("token_type"),t.path("/login"),e.resolve(),e.promise},c.handler=function(e){return o.localStorage.expires_in=e.data.expires_in,o.localStorage.access_token=e.data.access_token,o.localStorage.refresh_token=e.data.refresh_token,o.localStorage.token_type=e.data.token_type,e},c.isGuest=function(){var e=n.defer();return c.isLogged().then(function(){e.reject("auth.is_guest")})["catch"](function(){e.resolve(!0)}),e.promise},c.isLogged=function(){var e=n.defer();return o.localStorage.hasOwnProperty("expires_in")&&o.localStorage.hasOwnProperty("access_token")&&o.localStorage.hasOwnProperty("refresh_token")&&o.localStorage.hasOwnProperty("token_type")?e.resolve(!0):e.reject("auth.is_logged"),e.promise},c.refresh=function(){var t={grant_type:"refresh_token",client_id:a.client_id,client_secret:a.client_secret,scope:a.scopes.join(),refresh_token:o.localStorage.refresh_token};return e.post(r.get("access_token"),t).then(c.handler)},c.session=function(){return e.get(r.get("session"))},c.verify=function(t){var n={grant_type:"password",client_id:a.client_id,client_secret:a.client_secret,scope:a.scopes.join(),username:t.username,password:t.password};return e.post(r.get("access_token"),n).then(c.handler)},c}]),application.factory("Client",["$resource","API",function(e,t){return e(t.get("clients"),{client_id:"@id"},{"delete":{method:"DELETE"},get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!1},update:{method:"PUT"}})}]),application.factory("HttpInterceptor",["$injector","$q","$translate","$window",function(e,t,n,o){var r=null,a={};return a.request=function(t){if(e.get("Auth").isLogged()){var n=o.localStorage.token_type,r=o.localStorage.access_token;t.headers.Authorization=n+" "+r}return t},a.responseError=function(o){switch(console.error(o),o.status){case 401:return r=r?r:e.get("Auth").refresh(),r["finally"](function(){r=null}).then(function(){return e.get("$http")(o.config)});case 422:return n("toast_validation_failed").then(function(t){var n=e.get("$mdToast"),o=n.simple().content(t).position("bottom left right");n.show(o)}),t.reject(o);case 500:return"The user credentials were incorrect."==o.data.message?(n("toast_incorrect_credentials").then(function(t){var n=e.get("$mdToast"),o=n.simple().content(t).position("bottom left right");n.show(o)}),t.reject(o)):("The refresh token is invalid."==o.data.message&&n("toast_invalid_refresh_token").then(function(t){var n=e.get("$mdToast"),o=n.simple().content(t).position("bottom left right");n.show(o)}),e.get("Auth").forget(),t.reject(o))}},a}]),application.factory("User",["$resource","API",function(e,t){return e(t.get("users"),{user_id:"@id"},{"delete":{method:"DELETE"},get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!1},update:{method:"PUT"}})}]);
//# sourceMappingURL=application.min.js.map